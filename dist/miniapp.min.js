!function(){if(/mobile/i.test(navigator.userAgent)){var e=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function t(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function n(e,t,n){var i;if(localStorage)localStorage.setItem(e,t);else{if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),i=", expires="+o.toGMTString()}else i="";document.cookie=e+"="+t+i+", path=/"}}function i(e){if(localStorage)return localStorage.getItem(e);for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null}function o(){var e=i("miniappuuid");return null===e&&(e=t(),n("miniappuuid",e,365)),e}function a(){this.addClass=function(e,t){this[e]=t},this.addService=function(e,t){this[e]=t},this.getGuid=function(){return s}}function l(){var e=new a;return e}var r,s=o();return{getInstance:function(){return r||(r=l()),r}}}();!function(){e.getInstance().addService("http",function(){function t(e,t,n){var i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(e){if(4==this.readyState&&200==this.status)try{var t=JSON.parse(this.response);n(t)}catch(i){console.log("getPanelStyle Parse Error",i),n({})}};var o="";for(var a in t)o+=a+"="+t[a]+"&";i.send(o)}function n(e,n){t(a+"/api/miniapps/initparams/",e,function(e){n(e)})}function i(e,n){t(a+"/api/miniapps/related/",e,function(e){n(e)})}function o(n,i,o,l){var r={};navigator&&(r.language=navigator.language);var s={clientID:"",deviceID:"",action:n,timestamp:(new Date).getTime(),hostAppName:"haaretz",miniAppName:o||"",sdkVersion:"1.0web",hostAppUserId:"",os_name:"",os_version:"",device_brand:"",device_manufacturer:"",device_model:"",device_type:"",carrier:"web",language:r.language,ip:"",adIdentifier:e.getInstance().getGuid(),adid:"",articleURL:i,presentedMiniapps:l||["","","",""]};t(a+"/api/engagment/create/",s,function(){})}var a="http://dev.miniapp.me";return{getPanelStyle:n,getMiniapps:i,engageEvent:o}}())}(),function(){function t(e){function t(){return l}function n(e){f.push(e)}function i(){for(var e=0;e<f.length;e++)f[e](u)}function o(e){var t=document.createElement("div");t.style["float"]="left",t.style.marginRight="0px",t.style.marginLeft="0px",t.style.cursor="pointer",t.style.width="80px",t.style.textAlign="center",t.id=r;var n=document.createElement("img");n.style.borderRadius="5px",n.style.margin="auto",n.style.width="45px",n.style.height="45px",n.style.borderRadius="10px",n.src=p,t.appendChild(n);var o=document.createElement("div");o.style.textAlign="center",o.style.fontFamily="'Roboto', sans-serif",o.style.fontSize="11px",o.style.color="#ffffff";var a=s;return a.length>12&&(a=a.substr(0,10)+"..."),o.textContent=a,t.appendChild(o),t.onclick=function(){i()},t}function a(){r=e.id,p=e.icon,s=e.name,c=e.appAddress,d=e.appDownloadLink,l=o()}if(!(e&&e.icon&&e.id))return null;var l,r,s,p,c,d,u,f=[];return a(),u={getElement:t,getAppAddress:function(){return c},getAppDownloadLink:function(){return d},getAppIcon:function(){return p},getAppName:function(){return s},getAppId:function(){return r},onClick:n}}e.getInstance().addClass("AppIcon",t)}(),function(){function t(t){function n(){var e="miniappFontCSS";if(!document.getElementById(e)){var t=document.getElementsByTagName("head")[0],n=document.createElement("link");n.id=e,n.rel="stylesheet",n.type="text/css",n.href="http://fonts.googleapis.com/css?family=Roboto:300",n.media="all",t.appendChild(n)}}function i(){return m}function o(){g.style.display="none"}function a(){function e(){var t=parseInt(g.style.bottom)+1;g.style.bottom=t+"px",0>t?setTimeout(e,1):"function"==typeof i&&i(!0)}function n(){var e=parseInt(g.style.left)+4;g.style.left=e+"px",0>e?setTimeout(n,1):(g.style.left=0,"function"==typeof i&&i(!0))}var i;if(m.length>0)switch(t.AnimationType){case 0:g.style.left=-window.innerWidth+"px",g.style.display="block",n();break;default:g.style.bottom=-parseInt(g.style.height)+"px",g.style.display="block",e()}else"function"==typeof i&&i(!1);return{done:function(e){i=e}}}function l(){return g}function r(e,n){t.preloadFrames!==!1&&n.preLoadAppInFrame(e);var i=e&&e.getElement();i&&(h.appendChild(i),e.onClick(p),n.onHide(s),m.push({app:e,frame:n}),c())}function s(e,t){e===y&&t&&(y=null)}function p(t){for(var n=0;n<m.length;n++){var i=!0;y&&(i=!1),m[n].app==t?y===m[n].frame?(e.getInstance().http.engageEvent("CloseMiniApp",window.location.href,m[n].app.getAppId(),m.map(function(e){return e.app.getAppId()})),m[n].frame.hide(!0,!0)):(e.getInstance().http.engageEvent("OpenMiniApp",window.location.href,m[n].app.getAppId(),m.map(function(e){return e.app.getAppId()})),m[n].frame.show(i),y=m[n].frame):m[n].frame.hide(i)}}function c(){for(var e=0,t=0;t<m.length;t++)e+=parseInt(m[t].app.getElement().style.width),e+=parseInt(m[t].app.getElement().style.marginLeft),e+=parseInt(m[t].app.getElement().style.marginRight);h.style.width=e+"px"}function d(e){var n=document.createElement("div"),i=document.createElement("div");return h=u(),i.style.position="relative",i.style.height=(e.PanelHeight||90)+"px",n.appendChild(i),i.appendChild(h),n.style.position="fixed",n.style.bottom=0,n.style.left=0,n.style.width="100%",n.style.height=(e.PanelHeight||90)+"px",n.style.opacity=e.PanelAlpha||1,n.style.backgroundColor=e.PanelBackground||"#404040",n.style.display="none",n.style.zIndex=1e3,t.id&&(n.id=t.id),n}function u(){var e=document.createElement("div");return e.style.position="absolute",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.webkitTransform="translate(-50%, -50%)",e}function f(){n(),g=d(t),document.body.appendChild(g)}t||(t={});var g,h,y,m=[];return f(),{addMiniapp:r,removeMiniapps:{},getMiniapps:i,setStyle:{},getElement:l,hide:o,show:a}}e.getInstance().addClass("Panel",t)}(),function(){function t(e){function t(e){y.push(e)}function n(){return p}function i(e,t){function n(){var e=parseInt(p.style.left)-4;p.style.left=e+"px",e>-window.innerWidth?setTimeout(n,1):p.style.left=-window.innerWidth+"px"}if(h){e===!1?p.style.left=-window.innerWidth+"px":n(),h=!1;for(var i=0;i<y.length;i++)y[i](g,t)}}function o(e){function t(){var e=parseInt(p.style.left)+4;p.style.left=e+"px",0>e?setTimeout(t,1):p.style.left=0}e===!1?p.style.left=0:(p.style.left=-window.innerWidth+"px",t()),h=!0}function a(e){c.src=e.getAppAddress(),p.style.left=-window.innerWidth+"px",p.style.display="block",u.src=e.getAppIcon(),f=e}function l(e){var t=document.createElement("div");d=r(e),t.appendChild(d),t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="100%",t.style.height=window.innerHeight-45+"px",t.style.display="none",c=document.createElement("iframe");var n=document.createElement("div");return n.style.overflow="auto",n.style.webkitOverflowScrolling="touch",n.style.height=parseInt(t.style.height)-parseInt(d.style.height)+"px",n.appendChild(c),c.width="100%",c.height=parseInt(t.style.height)-parseInt(d.style.height),c.style.border="none",t.appendChild(n),t}function r(e){var t=document.createElement("div");t.style.textAlign="center",t.style.backgroundColor="#ffffff",t.style.border="1px #007AFF solid",t.style.height="45px",t.style.position="relative";var n=document.createElement("div");n.style.position="absolute",n.style.top="50%",n.style.width="100%",n.style.left=0,n.style.transform="translate(0, -50%)",n.style.webkitTransform="translate(0, -50%)",n.style.color="#000000",t.appendChild(n),u=document.createElement("img"),u.style.position="absolute",u.style.top=0,u.style.left="50%",u.style.transform="translate(-50%, 0)",u.style.webkitTransform="translate(-50%, 0)",u.style.width="45px",u.style.height="45px",u.style.marginTop="-11px",n.appendChild(u);var o=document.createElement("div");o.textContent=e.BackNavigationText,o.style["float"]="left",o.style.marginLeft="10px",o.style.cursor="pointer",window.getComputedStyle&&(o.style.fontFamily=window.getComputedStyle(document.body).fontFamily),o.style.fontSize="18px",o.onclick=function(){i(!0,!0)},n.appendChild(o);var a=document.createElement("img");return a.style["float"]="right",a.src="http://www.haaretz.co.il/htz/images/mobileweb/logo-haaretz.png",n.appendChild(a),t}function s(){p=l(e||{}),document.body.appendChild(p)}e||(e={});var p,c,d,u,f,g,h=!1,y=[];return s(),g={getElement:n,preLoadAppInFrame:a,show:o,hide:i,onHide:t}}e.getInstance().addClass("DisplayFrame",t)}(),function(){console.log("MiniAppSDK init");var t,n=e.getInstance(),i={publisher:"haaretz"};n.http.engageEvent("OpenArticle",window.location.href),n.http.getPanelStyle(i,function(e){e&&e[0]&&(e=e[0]),t=n.Panel(e);var i={link:window.location.href,publisher:"haaretz"};n.http.getMiniapps(i,function(i){console.log("MiniAppSDK "+i.length+" MiniApps"),i&&i.length&&i.length>0&&n.http.engageEvent("ShowMiniAppPanel",window.location.href,"",i.map(function(e){return e.id}));for(var o=0;o<i.length;o++)if(i[o]){var a=n.DisplayFrame(e),l=n.AppIcon(i[o]);t.addMiniapp(l,a),n.http.engageEvent("Impression",window.location.href,i[o].id,i.map(function(e){return e.id}))}}),setTimeout(function(){t.show()},8001)}),console.log("MiniAppSDK init completed")}()}}();